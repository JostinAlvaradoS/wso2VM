/*! For license information please see APICreateRoutes.953b371a4ef430ecd706.bundle.js.LICENSE.txt */
"use strict";(this.webpackChunk_wso2apim_publisher=this.webpackChunk_wso2apim_publisher||[]).push([[879],{54178:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Nr});var n=r(96540),a=r(11848),i=r(56347),o=r(8843),l=r(49450),s=r(5556),c=r.n(s),u=r(33551),p=r(99020),d=r(69067),f=r(58065),m=r(38798),y=r(74010),A=r(54625),v=r(84712),g=r(73357),h=r(4686),b=r(21070),P=r(98587),E=r(58168),I=r(34164),C=r(64111),w=r(17437),S=r(771),x=r(73788),O=r(28466),M=r(3541),D=r(27553),j=r(17245);function T(e){return(0,j.Ay)("MuiLinearProgress",e)}(0,D.A)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);var L=r(74848);const W=["className","color","value","valueBuffer","variant"];let k,V,R,F,N,B,G=e=>e;const _=(0,w.keyframes)(k||(k=G`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`)),U=(0,w.keyframes)(V||(V=G`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`)),q=(0,w.keyframes)(R||(R=G`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`)),$=(e,t)=>"inherit"===t?"currentColor":e.vars?e.vars.palette.LinearProgress[`${t}Bg`]:"light"===e.palette.mode?(0,S.a)(e.palette[t].main,.62):(0,S.e$)(e.palette[t].main,.5),Q=(0,a.Ay)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`color${(0,O.A)(r.color)}`],t[r.variant]]}})((({ownerState:e,theme:t})=>(0,E.A)({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:$(t,e.color)},"inherit"===e.color&&"buffer"!==e.variant&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},"buffer"===e.variant&&{backgroundColor:"transparent"},"query"===e.variant&&{transform:"rotate(180deg)"}))),z=(0,a.Ay)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.dashed,t[`dashedColor${(0,O.A)(r.color)}`]]}})((({ownerState:e,theme:t})=>{const r=$(t,e.color);return(0,E.A)({position:"absolute",marginTop:0,height:"100%",width:"100%"},"inherit"===e.color&&{opacity:.3},{backgroundImage:`radial-gradient(${r} 0%, ${r} 16%, transparent 42%)`,backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})}),(0,w.css)(F||(F=G`
    animation: ${0} 3s infinite linear;
  `),q)),K=(0,a.Ay)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.bar,t[`barColor${(0,O.A)(r.color)}`],("indeterminate"===r.variant||"query"===r.variant)&&t.bar1Indeterminate,"determinate"===r.variant&&t.bar1Determinate,"buffer"===r.variant&&t.bar1Buffer]}})((({ownerState:e,theme:t})=>(0,E.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:"inherit"===e.color?"currentColor":(t.vars||t).palette[e.color].main},"determinate"===e.variant&&{transition:"transform .4s linear"},"buffer"===e.variant&&{zIndex:1,transition:"transform .4s linear"})),(({ownerState:e})=>("indeterminate"===e.variant||"query"===e.variant)&&(0,w.css)(N||(N=G`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    `),_))),J=(0,a.Ay)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.bar,t[`barColor${(0,O.A)(r.color)}`],("indeterminate"===r.variant||"query"===r.variant)&&t.bar2Indeterminate,"buffer"===r.variant&&t.bar2Buffer]}})((({ownerState:e,theme:t})=>(0,E.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},"buffer"!==e.variant&&{backgroundColor:"inherit"===e.color?"currentColor":(t.vars||t).palette[e.color].main},"inherit"===e.color&&{opacity:.3},"buffer"===e.variant&&{backgroundColor:$(t,e.color),transition:"transform .4s linear"})),(({ownerState:e})=>("indeterminate"===e.variant||"query"===e.variant)&&(0,w.css)(B||(B=G`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
    `),U))),Y=n.forwardRef((function(e,t){const r=(0,M.A)({props:e,name:"MuiLinearProgress"}),{className:n,color:a="primary",value:i,valueBuffer:o,variant:l="indeterminate"}=r,s=(0,P.A)(r,W),c=(0,E.A)({},r,{color:a,variant:l}),u=(e=>{const{classes:t,variant:r,color:n}=e,a={root:["root",`color${(0,O.A)(n)}`,r],dashed:["dashed",`dashedColor${(0,O.A)(n)}`],bar1:["bar",`barColor${(0,O.A)(n)}`,("indeterminate"===r||"query"===r)&&"bar1Indeterminate","determinate"===r&&"bar1Determinate","buffer"===r&&"bar1Buffer"],bar2:["bar","buffer"!==r&&`barColor${(0,O.A)(n)}`,"buffer"===r&&`color${(0,O.A)(n)}`,("indeterminate"===r||"query"===r)&&"bar2Indeterminate","buffer"===r&&"bar2Buffer"]};return(0,C.A)(a,T,t)})(c),p=(0,x.I)(),d={},f={bar1:{},bar2:{}};if(("determinate"===l||"buffer"===l)&&void 0!==i){d["aria-valuenow"]=Math.round(i),d["aria-valuemin"]=0,d["aria-valuemax"]=100;let e=i-100;p&&(e=-e),f.bar1.transform=`translateX(${e}%)`}if("buffer"===l&&void 0!==o){let e=(o||0)-100;p&&(e=-e),f.bar2.transform=`translateX(${e}%)`}return(0,L.jsxs)(Q,(0,E.A)({className:(0,I.A)(u.root,n),ownerState:c,role:"progressbar"},d,{ref:t},s,{children:["buffer"===l?(0,L.jsx)(z,{className:u.dashed,ownerState:c}):null,(0,L.jsx)(K,{className:u.bar1,ownerState:c,style:f.bar1}),"determinate"===l?null:(0,L.jsx)(J,{className:u.bar2,ownerState:c,style:f.bar2})]}))})),H=Y;var X=r(34339);function Z(e){var t=e.title,r=e.children;return n.createElement(p.Ay,{container:!0},n.createElement(p.Ay,{item:!0,sm:!1,md:3}),n.createElement(p.Ay,{item:!0,sm:12,md:6},n.createElement(p.Ay,{container:!0,sx:{pt:2}},n.createElement(p.Ay,{item:!0,md:12,sx:{mb:3}},t),n.createElement(p.Ay,{item:!0,xs:12,md:12},n.createElement(X.A,{elevation:0,sx:{p:5}},r)))))}Z.propTypes={title:c().element.isRequired,children:c().arrayOf(c().element).isRequired};var ee=r(1043),te=r(25239),re=r(19455),ne=r(92728),ae=r(69554),ie=r(48805),oe=r(45359),le=r(6347),se=r(69307),ce=r(53215),ue=r(41340),pe=r(1403),de=r(3542);function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function me(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ge(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}function ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(r),!0).forEach((function(t){be(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||ge(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){if(e){if("string"==typeof e)return he(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?he(e,t):void 0}}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function be(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=fe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Pe="DefaultAPIForm",Ee={mandatoryStar:"".concat(Pe,"-mandatoryStar"),helperTextContext:"".concat(Pe,"-helperTextContext"),endpointValidChip:"".concat(Pe,"-endpointValidChip"),endpointInvalidChip:"".concat(Pe,"-endpointInvalidChip"),endpointErrorChip:"".concat(Pe,"-endpointErrorChip"),iconButton:"".concat(Pe,"-iconButton"),iconButtonValid:"".concat(Pe,"-iconButtonValid"),radioOutline:"".concat(Pe,"-radioOutline"),label:"".concat(Pe,"-label"),newLabel:"".concat(Pe,"-newLabel")},Ie=(0,a.Ay)(p.Ay)((function(e){var t=e.theme;return be(be(be(be(be(be(be(be(be(be({},"& .".concat(Ee.mandatoryStar),{color:t.palette.error.main,marginLeft:t.spacing(.1)}),"& .".concat(Ee.helperTextContext),{"& p":{textOverflow:"ellipsis",width:400,display:"block",whiteSpace:"nowrap",overflow:"hidden"}}),"& .".concat(Ee.endpointValidChip),{color:"green",border:"1px solid green"}),"& .".concat(Ee.endpointInvalidChip),{color:"#ffd53a",border:"1px solid #ffd53a"}),"& .".concat(Ee.endpointErrorChip),{color:"red",border:"1px solid red"}),"& .".concat(Ee.iconButton),{padding:t.spacing(1)}),"& .".concat(Ee.iconButtonValid),{padding:t.spacing(1),color:de.A[500]}),"& .".concat(Ee.radioOutline),{display:"flex",alignItems:"center",padding:"10px",marginTop:"10px",marginLeft:"15px",marginRight:"8px",borderRadius:"8px",transition:"border 0.3s","&.Mui-checked":{border:"2px solid ".concat(t.palette.primary.main)}}),"& .".concat(Ee.label),{marginLeft:"10px"}),"& .".concat(Ee.newLabel),{backgroundColor:"green",color:"white",fontWeight:"bold",fontSize:"0.6rem",padding:"2px 4px",borderRadius:"4px",marginLeft:"10px",display:"inline-block"})}));function Ce(e,t){var r,n=e.context,a=e.version;return r=t?"{channel}/{version}":"{context}/{version}",n&&(r=n,n.indexOf("{version}")<0&&(r=n+"/{version}")),a&&(r=r.replace("{version}",a)),r}function we(e){var t=e.onChange,r=e.onValidate,a=e.api,i=e.isAPIProduct,o=e.multiGateway,l=e.isWebSocket,s=e.children,c=e.appendChildrenBeforeEndpoint,d=e.hideEndpoint,m=ve((0,n.useState)({}),2),y=m[0],A=m[1],v=ve((0,n.useState)(),2),b=v[0],P=v[1],E=ve((0,n.useState)(""),2),I=E[0],C=E[1],w=ve((0,n.useState)(!1),2),S=w[0],x=w[1],O=ve((0,n.useState)(!1),2),M=O[0],D=O[1],j=function(e){return a.gatewayType===e?"2px solid #1976D2":"2px solid gray"};(0,n.useEffect)((function(){r(Boolean(a.name)&&Boolean(a.version)&&Boolean(a.context))}),[]);var T,L,W,k=function(e){var t=Object.entries(e).length>0&&Object.entries(e).map((function(e){return null==ve(e,2)[1]})).reduce((function(e,t){return e&&t}));t=t&&Boolean(a.name)&&Boolean(a.version)&&Boolean(a.context),r(t,y),A(e)};function V(e,t){switch(e){case"name":var r=ie.A.apiName.validate(t,{abortEarly:!1}).error;null===r?ie.A.apiParameter.validate(e+":"+t).then((function(e){k(Ae(Ae({},y),{},!0===e?{name:{details:[{message:n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.validation.error.name.exists",defaultMessage:[{type:0,value:"Name "},{type:1,value:"value"},{type:0,value:" already exists"}],values:{value:t}})}]}}:{name:r}))})):k(Ae(Ae({},y),{},{name:r}));break;case"context":var a=ie.A.apiContext.required().validate(t,{abortEarly:!1}).error,i=t.startsWith("/")?t:"/"+t;if(null===a){var o,s=me(i.split("/"));try{for(s.s();!(o=s.n()).done;){var c=o.value;null!==c&&"{version}"!==c&&(c.includes("{version}")?(a=ie.A.apiContextWithoutKeyWords.required().validate(t,{abortEarly:!1}).error,k(Ae(Ae({},y),{},{context:{details:[{message:n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.validation.error.version.exists.as.a.substring.in.path.param",defaultMessage:[{type:1,value:"version"},{type:0,value:" cannot exist as a substring in a path param"}]})}]}}))):(c.includes("{")||c.includes("}"))&&(a=ie.A.apiContextWithoutKeyWords.required().validate(t,{abortEarly:!1}).error,k(Ae(Ae({},y),{},{context:{details:[{message:n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.validation.error.curly.braces.cannot.be.in.path.param",defaultMessage:[{type:1,value:"or"},{type:0,value:" cannot exist as a substring in a path param"}]})}]}}))))}}catch(e){s.e(e)}finally{s.f()}var u=0;if(null===a){var p,d=me(i);try{for(d.s();!(p=d.n()).done;){var m=p.value;"("===m?u++:")"===m&&u--,u<0&&k(Ae(Ae({},y),{},{context:{details:[{message:n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.validation.error.unbalanced.parantheses",defaultMessage:[{type:0,value:"Parentheses should be balanced in API context"}]})}]}}))}}catch(e){d.e(e)}finally{d.f()}u>0&&k(Ae(Ae({},y),{},{context:{details:[{message:n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.validation.error.unbalanced.parantheses",defaultMessage:[{type:0,value:"Parentheses should be balanced in API context"}]})}]}}))}null===a&&0===u&&ie.A.apiParameter.validate(e+":"+i).then((function(e){k(Ae(Ae({},y),{},!0===e?{context:{details:[{message:l?i+" channel already exists":i+" context already exists"}]}}:{context:a,version:null}))}))}else k(Ae(Ae({},y),{},{context:a}));break;case"version":var A=ie.A.apiVersion.required().validate(t).error;k(Ae(Ae({},y),{},{version:A}));break;case"endpoint":if(l&&t&&t.length>0){var v=ie.A.wsUrl.validate(t).error;k(Ae(Ae({},y),{},{endpointURL:v}))}}}return n.createElement(Ie,{item:!0,md:12},n.createElement("form",{noValidate:!0,autoComplete:"off"},n.createElement(ee.A,{autoFocus:!0,fullWidth:!0,id:"api-name",error:Boolean(y.name),label:n.createElement(n.Fragment,null,n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.name",defaultMessage:[{type:0,value:"Name"}]}),n.createElement("sup",{className:Ee.mandatoryStar},"*")),helperText:y.name&&y.name.details.map((function(e,t){return n.createElement("div",{style:{marginTop:0!==t&&"10px"}},e.message)})),value:a.name,name:"name",onChange:t,InputProps:{id:"itest-id-apiname-input",onBlur:function(e){V("name",e.target.value)}},InputLabelProps:{for:"itest-id-apiname-input"},margin:"normal",variant:"outlined"}),n.createElement(p.Ay,{container:!0,spacing:2},i?n.createElement(n.Fragment,null,n.createElement(p.Ay,{item:!0,md:8,xs:6},n.createElement(ee.A,{fullWidth:!0,id:"context",error:Boolean(y.context),label:n.createElement(n.Fragment,null,n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.api.product.context",defaultMessage:[{type:0,value:"Context"}]}),n.createElement("sup",{className:Ee.mandatoryStar},"*")),name:"context",value:a.context,onChange:t,InputProps:{onBlur:function(e){V("context",e.target.value)}},helperText:y.context&&y.context.details.map((function(e,t){return n.createElement("div",{key:e.message,style:{marginTop:0!==t&&"10px"}},e.message)}))||n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.api.product.actual.context.helper",defaultMessage:[{type:0,value:"API Product will be exposed in "},{type:1,value:"actualContext"},{type:0,value:"context at the gateway"}],values:{actualContext:Ce(a)}}),margin:"normal",variant:"outlined"})),n.createElement(p.Ay,{item:!0,md:4,xs:6},n.createElement(ee.A,{fullWidth:!0,id:"version",error:Boolean(y.version),label:n.createElement(n.Fragment,null,n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.api.product.version",defaultMessage:[{type:0,value:"Version"}]}),n.createElement("sup",{className:Ee.mandatoryStar},"*")),name:"version",value:a.version,onChange:t,InputProps:{id:"itest-id-apiversion-input",onBlur:function(e){V("version",e.target.value)}},InputLabelProps:{for:"itest-id-apiversion-input"},helperText:y.version&&y.version.message,margin:"normal",variant:"outlined"}))):n.createElement(n.Fragment,null,n.createElement(p.Ay,{item:!0,md:8,xs:6},n.createElement(ee.A,{fullWidth:!0,id:"context",error:Boolean(y.context),label:n.createElement(n.Fragment,null,l?n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.api.channel",defaultMessage:[{type:0,value:"Channel"}]}):n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.api.context",defaultMessage:[{type:0,value:"Context"}]}),n.createElement("sup",{className:Ee.mandatoryStar},"*")),name:"context",value:a.context,onChange:t,InputProps:{id:"itest-id-apicontext-input",onBlur:function(e){V("context",e.target.value)}},InputLabelProps:{for:"itest-id-apicontext-input"},helperText:y.context&&y.context.details.map((function(e,t){return n.createElement("div",{style:{marginTop:0!==t&&"10px"}},e.message)}))||n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.api.actual.context.helper",defaultMessage:[{type:0,value:"API will be exposed in "},{type:1,value:"actualContext"},{type:0,value:" context at the gateway"}],values:{actualContext:Ce(a,l)}}),classes:{root:Ee.helperTextContext},margin:"normal",variant:"outlined"})),n.createElement(p.Ay,{item:!0,md:4,xs:6},n.createElement(ee.A,{fullWidth:!0,id:"version",error:Boolean(y.version),label:n.createElement(n.Fragment,null,n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.version",defaultMessage:[{type:0,value:"Version"}]}),n.createElement("sup",{className:Ee.mandatoryStar},"*")),name:"version",value:a.version,onChange:t,InputProps:{id:"itest-id-apiversion-input",onBlur:function(e){V("version",e.target.value)}},InputLabelProps:{for:"itest-id-apiversion-input"},helperText:y.version&&y.version.message,margin:"normal",variant:"outlined"})))),c&&!!s&&s,!i&&!d&&n.createElement(ee.A,{fullWidth:!0,id:"itest-id-apiendpoint-input",label:n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.api.endpoint",defaultMessage:[{type:0,value:"Endpoint"}]}),name:"endpoint",value:a.endpoint,onChange:t,helperText:y.endpointURL&&y.endpointURL.details.map((function(e,t){return n.createElement("div",{style:{marginTop:0!==t&&"10px"}},e.message)})),error:Boolean(y.endpointURL),margin:"normal",variant:"outlined",InputProps:{onBlur:function(e){V("endpoint",e.target.value)},endAdornment:n.createElement(te.A,{position:"end"},I&&n.createElement(ae.A,{label:I,className:b?Ee.endpointValidChip:(T=M,L=Ee.endpointErrorChip,W=Ee.endpointInvalidChip,T?L:W),variant:"outlined"}),!l&&n.createElement(re.A,{className:b?Ee.iconButtonValid:Ee.iconButton,"aria-label":"TestEndpoint",onClick:function(){return e=a.endpoint,x(!0),void(new h.A).testEndpoint(e).then((function(e){null!==e.body.error?(C(e.body.error),D(!0)):(C(e.body.statusCode+" "+e.body.statusMessage),D(!1)),e.body.statusCode>=200&&e.body.statusCode<300?(P(!0),D(!1)):P(!1)})).finally((function(){x(!1)}));var e},disabled:S,size:"large"},S?n.createElement(g.A,{size:20}):n.createElement(ne.A,null,"check_circle")))}}),o&&n.createElement(p.Ay,{container:!0,spacing:2},n.createElement(oe.A,{component:"fieldset"},n.createElement(se.A,{sx:{marginLeft:"15px",marginTop:"20px"}},n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.select.gateway.type",defaultMessage:[{type:0,value:"Select Gateway type"}]})),n.createElement(ue.A,{row:!0,"aria-label":"gateway-type",name:"gatewayType",value:a.gatewayType,onChange:t},n.createElement(p.Ay,{item:!0,xs:6},n.createElement(pe.A,{value:"wso2/synapse",className:Ee.radioOutline,control:n.createElement(ce.A,null),label:n.createElement("div",null,n.createElement("span",null,n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.regular.gateway.type",defaultMessage:[{type:0,value:"Regular Gateway"}]})),n.createElement(u.A,{variant:"body2",color:"textSecondary"},n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.regular.gateway.type.text",defaultMessage:[{type:0,value:"API gateway embedded in APIM runtime. Connect directly APIManager."}]}))),sx:{border:j("wso2/synapse")}})),n.createElement(p.Ay,{item:!0,xs:6},n.createElement(pe.A,{value:"wso2/apk",className:Ee.radioOutline,control:n.createElement(ce.A,null),label:n.createElement("div",null,n.createElement("span",null,n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.apk.gateway.type",defaultMessage:[{type:0,value:"APK Gateway"}]})),n.createElement("span",{className:"".concat(Ee.label," ").concat(Ee.newLabel)},"New"),n.createElement(u.A,{variant:"body2",color:"textSecondary"},n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.apk.gateway.type.text",defaultMessage:[{type:0,value:"Fast API gateway running on kubernetes designed to manage and secure APIs."}]}))),sx:{border:j("wso2/apk")}}))),n.createElement(le.A,{sx:{marginLeft:"15px"}},n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.select.gateway.type.helper.text",defaultMessage:[{type:0,value:"Select the gateway type where your API will run."}]})))),!c&&!!s&&s),n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-end",alignItems:"center"},n.createElement(p.Ay,{item:!0},n.createElement(u.A,{variant:"caption",display:"block",gutterBottom:!0},n.createElement("sup",{style:{color:"red"}},"*")," ",n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.mandatory.fields",defaultMessage:[{type:0,value:"Mandatory fields"}]})))))}we.defaultProps={onValidate:function(){},api:{},isWebSocket:!1},we.propTypes={api:c().shape({}),multiGateway:c().string.isRequired,isAPIProduct:c().shape({}).isRequired,isWebSocket:c().shape({}),onChange:c().func.isRequired,onValidate:c().func};var Se=r(14739),xe=r(90431),Oe=r(85877);function Me(e){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me(e)}function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach((function(t){Te(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Te(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Me(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Me(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Me(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Le(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ke(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}function We(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||ke(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(e,t){if(e){if("string"==typeof e)return Ve(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ve(e,t):void 0}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Re(){Re=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,o=Object.create(i.prototype),l=new D(n||[]);return a(o,"_invoke",{value:S(e,r,l)}),o}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",f="suspendedYield",m="executing",y="completed",A={};function v(){}function g(){}function h(){}var b={};c(b,o,(function(){return this}));var P=Object.getPrototypeOf,E=P&&P(P(j([])));E&&E!==r&&n.call(E,o)&&(b=E);var I=h.prototype=v.prototype=Object.create(b);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(a,i,o,l){var s=p(e[a],e,i);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==Me(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,o,l)}),(function(e){r("throw",e,o,l)})):t.resolve(u).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,l)}))}l(s.arg)}var i;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function S(t,r,n){var a=d;return function(i,o){if(a===m)throw Error("Generator is already running");if(a===y){if("throw"===i)throw o;return{value:e,done:!0}}for(n.method=i,n.arg=o;;){var l=n.delegate;if(l){var s=x(l,n);if(s){if(s===A)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===d)throw a=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=m;var c=p(t,r,n);if("normal"===c.type){if(a=n.done?y:f,c.arg===A)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=y,n.method="throw",n.arg=c.arg)}}}function x(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),A;var i=p(a,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,A;var o=i.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,A):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,A)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Me(t)+" is not iterable")}return g.prototype=h,a(I,"constructor",{value:h,configurable:!0}),a(h,"constructor",{value:g,configurable:!0}),g.displayName=c(h,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,c(e,s,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},C(w.prototype),c(w.prototype,l,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var o=new w(u(e,r,n,a),i);return t.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},C(I),c(I,s,"Generator"),c(I,o,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return l.type="throw",l.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],l=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),A},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),A}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;M(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),A}},t}function Fe(e,t,r,n,a,i,o){try{var l=e[i](o),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(n,a)}function Ne(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){Fe(i,n,a,o,l,"next",e)}function l(e){Fe(i,n,a,o,l,"throw",e)}o(void 0)}))}}var Be=function(){var e=Ne(Re().mark((function e(){var t,r;return Re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.A.policies("subscription"),e.next=3,t;case 3:return r=e.sent,e.abrupt("return",r.body.list);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function Ge(e){var t=e.isWebSocket,r=e.isAPIProduct,a=e.history,i=e.intl,o=e.multiGateway,s=(0,l.Jy)(),c=s.data,m=s.isLoading,P=s.error,E=We((0,n.useState)(!1),2),I=E[0],C=E[1],w=We((0,n.useState)(null),2),S=w[0],x=w[1];(0,n.useEffect)((function(){P&&x(P.message)}),[P]),(0,n.useEffect)((function(){if(null!=c&&c.gatewayTypes&&1===c.gatewayTypes.length){var e,t=Le(c.environment);try{for(t.s();!(e=t.n()).done;)if(e.value.gatewayType===c.gatewayTypes[0]){C(!0);break}}catch(e){t.e(e)}finally{t.f()}}}),[c]);var O=We((0,n.useState)(),2),M=O[0],D=O[1],j=We((0,n.useState)(!1),2),T=j[0],L=j[1],W=We((0,n.useState)(!1),2),k=W[0],V=W[1],R=We((0,n.useState)(!1),2),F=R[0],N=R[1],B=We((0,n.useState)(!1),2),G=B[0],_=B[1],U=We((0,n.useState)(!1),2),q=U[0],$=U[1],Q=We((0,n.useReducer)((function(e,t){var r=t.action,n=t.value;switch(r){case"name":case"version":case"endpoint":case"context":case"gatewayType":case"isFormValid":return je(je({},e),{},Te({},r,n));default:return e}}),{formValidity:!1}),2),z=Q[0],K=Q[1],J=z.endpoint,Y=!(z.name&&z.version&&z.context)||M||T;function X(){return ee.apply(this,arguments)}function ee(){return ee=Ne(Re().mark((function e(){var n,o,l,s,u,p,d,f,m,y,A,g;return Re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),n=z.name,o=z.version,l=z.context,s=z.endpoint,u=z.gatewayType,e.next=4,Be();case 4:return 0===(m=e.sent).length?v.A.info(i.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.policies.not.available",defaultMessage:[{type:0,value:"Throttling policies not available. Contact your administrator"}]})):d=m.filter((function(e){return"Unlimited"===e.name})).length>0?["Unlimited"]:[m[0].name],f=c&&1===c.gatewayTypes.length&&c.gatewayTypes.includes("Regular")?"wso2/synapse":c&&1===c.gatewayTypes.length&&c.gatewayTypes.includes("APK")?"wso2/apk":"default",y={name:n,version:o,context:l,gatewayType:"default"===f?u:f,policies:d},s&&(y.endpointConfig={endpoint_type:"http",sandbox_endpoints:{url:s},production_endpoints:{url:s}}),t&&(y.type="WS"),r?(A=new Se.A(y),p=A.saveProduct(y).then((function(e){return v.A.info(i.formatMessage({id:"Apis.Create.Default.APICreateDefault.api.product.created.success",defaultMessage:[{type:0,value:"API Product created successfully"}]})),a.push("/api-products/".concat(e.id,"/overview")),e})).catch((function(e){if(console.error(e),e.response)return x(e.response.body),e.response.body.description;var t=i.formatMessage({id:"Apis.Create.Default.APICreateDefault.api.product.created.error",defaultMessage:[{type:0,value:"Something went wrong while adding the API Product"}]});return x(t),t}))):(g=new h.A(y),p=g.save(),v.A.loading(p,{loading:"Creating API...",success:i.formatMessage({id:"Apis.Create.Default.APICreateDefault.api.created.success",defaultMessage:[{type:0,value:"API created successfully"}]}),error:function(e){if(console.error(e),L(!1),e.response)return x(e.response.body),e.response.body.description;var t=i.formatMessage({id:"Apis.Create.Default.APICreateDefault.api.created.error",defaultMessage:[{type:0,value:"Something went wrong while adding the API"}]});return x(t),t}})),e.abrupt("return",p.finally((function(){return D(!1)})));case 12:case"end":return e.stop()}}),e)}))),ee.apply(this,arguments)}(0,n.useEffect)((function(){null!=c&&c.customProperties&&c.customProperties.length>0&&_(!0)}),[c]);var te=n.createElement(n.Fragment,null,n.createElement(u.A,{variant:"h5",component:"h1"},n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.api.heading",defaultMessage:[{type:0,value:"Create an API"}]})),n.createElement(u.A,{variant:"caption"},n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.api.sub.heading",defaultMessage:[{type:0,value:"Create an API by providing a Name, a Version, a Context and Backend Endpoint (optional)"}]})));return r?te=n.createElement(n.Fragment,null,n.createElement(u.A,{variant:"h5",component:"h1"},n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.apiProduct.heading",defaultMessage:[{type:0,value:"Create an API Product"}]})),n.createElement(u.A,{variant:"caption"},n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.apiProduct.sub.heading",defaultMessage:[{type:0,value:"Create an API Product by providing a Name, a Context, and Business Plans (optional)."}]}))):t&&(te=n.createElement(n.Fragment,null,n.createElement(u.A,{variant:"h5",component:"h1"},n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.webSocket.heading",defaultMessage:[{type:0,value:"Create a WebSocket API"}]})),n.createElement(u.A,{variant:"caption"},n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.webSocket.sub.heading",defaultMessage:[{type:0,value:"Create a WebSocket API by providing a Name, and a Context."}]})))),m?n.createElement(Oe.A,null):n.createElement(Z,{title:te},n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"center",alignItems:"center"},S&&n.createElement(p.Ay,{item:!0,xs:11},n.createElement(b.A,{onClose:function(){return x(null)},disableActions:!0,dense:!0,paperProps:{elevation:1},type:"error",message:S})),n.createElement(p.Ay,{item:!0,xs:12},m&&n.createElement(d.A,{mt:-2},n.createElement(H,{"data-testid":"loading-publisher-settings"}))),n.createElement(p.Ay,{item:!0,xs:12,"data-testid":"default-api-form"},n.createElement(we,{onValidate:function(e){K({action:"isFormValid",value:e})},onChange:function(e){var t=e.target,r=t.name,n=t.value;K({action:r,value:n});var a=c&&c.environment;if(c&&2===c.gatewayTypes.length&&("wso2/synapse"===n||"wso2/apk"===n)){var i,o=Le(a);try{for(o.s();!(i=o.n()).done;){var l=i.value,s="";if("APK"===l.gatewayType?s="wso2/apk":"Regular"===l.gatewayType&&(s="wso2/synapse"),s===n){C(!0);break}C(!1)}}catch(e){o.e(e)}finally{o.f()}}},api:z,multiGateway:o,isAPIProduct:r,isWebSocket:t})),n.createElement(p.Ay,{item:!0,xs:12},n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},n.createElement(p.Ay,{item:!0},n.createElement(y.A,{id:"itest-create-default-api-button",variant:"contained",color:"primary",disabled:Y||!z.isFormValid,onClick:function(){X().then((function(e){a.push("/apis/".concat(e.id,"/overview"))}))}},n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.create.btn",defaultMessage:[{type:0,value:"Create"}]})," ",M&&!q&&n.createElement(g.A,{size:24}))),!G&&!xe.A.isNotPublisher()&&n.createElement(p.Ay,{item:!0},n.createElement(y.A,{id:"itest-id-apicreatedefault-createnpublish",variant:"contained",color:"primary",disabled:!I||F||k||!J||Y||!z.isFormValid,onClick:function(){var e=new h.A;$(!0),X().then((function(t){V(!0);var r=e.createRevision(t.id,{description:"Initial Revision"});v.A.loading(r,{success:i.formatMessage({id:"Apis.Create.Default.APICreateDefault.api.revision.created.success",defaultMessage:[{type:0,value:"API Revision created successfully"}]}),error:function(e){return console.error(e),e.response?(x(e.response.body),e.response.body.description):(x("Something went wrong while creating the API Revision"),i.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.errorMessage.create.revision",defaultMessage:[{type:0,value:"Something went wrong while creating the API Revision"}]}))},loading:"Creating API revision..."}),r.then((function(r){var n=r.body.id;V(!1);var o=c.environment.map((function(e){return e.name})),l=[],s=c.environment.filter((function(e){return e.provider&&e.provider.toLowerCase().includes("wso2")})),u=function(e){var t=s.find((function(t){return t.name===e&&t.vhosts.length>0}));return t&&t.vhosts[0].host};if(c.gatewayTypes&&1===c.gatewayTypes.length)o&&o.length>0&&(o.includes("Default")&&u("Default")?l.push({name:"Default",displayOnDevportal:!0,vhost:u("Default")}):u(o[0])&&l.push({name:o[0],displayOnDevportal:!0,vhost:u(o[0])}));else{var p=c.environment,d=!1;p.forEach((function(e){var t="";"APK"===e.gatewayType?t="wso2/apk":"Regular"===e.gatewayType&&(t="wso2/synapse"),!d&&t===z.gatewayType&&u(e.name)&&(l.push({name:e.name,displayOnDevportal:!0,vhost:u(e.name)}),d=!0)}))}N(!0);var f=e.deployRevision(t.id,n,l);v.A.loading(f,{loading:"Deploying API...",success:i.formatMessage({id:"Apis.Create.Default.APICreateDefault.api.revision.deployed.success",defaultMessage:[{type:0,value:"API Revision Deployed Successfully"}]}),error:function(e){return console.error(e),e.response?(x(e.response.body),e.response.body.description):(x("Something went wrong while publishing the API"),i.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.errorMessage.publish",defaultMessage:[{type:0,value:"Something went wrong while publishing the API"}]}))}}),f.then((function(e){if(N(!1),"CREATED"===e.body[0].status)L(!1),$(!1),a.push("/apis/".concat(t.id,"/overview"));else{L(!0);var r=t.publish();v.A.loading(r,{loading:"Publishing API...",success:function(e){return e.body.workflowStatus===Ge.WORKFLOW_STATUS.CREATED?i.formatMessage({id:"Apis.Create.Default.APICreateDefault.success.publishStatus",defaultMessage:[{type:0,value:"Lifecycle state change request has been sent"}]}):i.formatMessage({id:"Apis.Create.Default.APICreateDefault.success.otherStatus",defaultMessage:[{type:0,value:"API updated successfully"}]})},error:function(){return i.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.otherStatus",defaultMessage:[{type:0,value:"Error while publishing the API"}]})}}),r.then((function(){return a.push("/apis/".concat(t.id,"/overview"))})).finally((function(){L(!1),$(!1)}))}})).finally((function(){N(!1)}))})).finally((function(){V(!1)}))}))}},!T&&!k&&!F&&n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.create.publish.btn",defaultMessage:[{type:0,value:"Create & Publish"}]}),(T||k||F)&&n.createElement(g.A,{size:24}),M&&T&&n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.create.publish.btn.creating.status",defaultMessage:[{type:0,value:"Creating API . . ."}]}),!M&&k&&!F&&n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.create.publish.btn.creating.revision.status",defaultMessage:[{type:0,value:"Creating Revision . . ."}]}),!M&&T&&!k&&!F&&n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.create.publish.btn.creating.publishing.status",defaultMessage:[{type:0,value:"Publishing API . . ."}]}),!M&&T&&!k&&F&&n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.create.publish.btn.creating.deploying.revision.status",defaultMessage:[{type:0,value:"Deploying Revision . . ."}]}))),n.createElement(p.Ay,{item:!0},n.createElement(A.N_,{to:"/apis/"},n.createElement(y.A,{variant:"text"},n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))))))),n.createElement(p.Ay,{item:!0,xs:12},n.createElement(d.A,{mt:4})))}Ge.defaultProps={isWebSocket:!1,isAPIProduct:!1},Ge.WORKFLOW_STATUS={CREATED:"CREATED"},Ge.propTypes={history:c().shape({push:c().func}).isRequired,multiGateway:c().string.isRequired,isAPIProduct:c().shape({}),isWebSocket:c().shape({}),intl:c().shape({formatMessage:c().func}).isRequired};const _e=(0,i.y)((0,m.Ay)(Ge));var Ue=r(6442),qe=r(79595),$e=r(82997),Qe=r(47363);function ze(e){var t=e.title,r=e.children;return n.createElement(p.Ay,{container:!0},n.createElement(p.Ay,{item:!0,sm:!1,md:2}),n.createElement(p.Ay,{item:!0,sm:12,md:8},n.createElement(p.Ay,{container:!0,sx:{pt:2}},n.createElement(p.Ay,{item:!0,md:12,sx:{mb:3}},t),n.createElement(p.Ay,{item:!0,xs:12},n.createElement(X.A,{elevation:0,sx:{p:5}},r)))))}ze.propTypes={title:c().element.isRequired,children:c().element.isRequired};var Ke=r(19922);function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function Ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(r),!0).forEach((function(t){et(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ze(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ze(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function et(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Je(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Je(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Je(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var tt="APIProductCreateWrapper",rt={Paper:"".concat(tt,"-Paper"),saveButton:"".concat(tt,"-saveButton"),titleWrapper:"".concat(tt,"-titleWrapper"),buttonWrapper:"".concat(tt,"-buttonWrapper"),alternativeLabel:"".concat(tt,"-alternativeLabel")},nt=(0,a.Ay)("div")((function(e){var t=e.theme;return et(et(et(et(et({},"& .".concat(rt.Paper),{height:"40px"}),"& .".concat(rt.saveButton),{padding:"0px 0px 0px 10px"}),"& .".concat(rt.titleWrapper),{display:"flex",flexDirection:"row",alignItems:"center",paddingBottom:t.spacing(2)}),"& .".concat(rt.buttonWrapper),{marginTop:t.spacing(4)}),"& .".concat(rt.alternativeLabel),{marginTop:t.spacing(1)})}));function at(e){var t=e.history,r=(0,Ue.A)(),a=Xe((0,n.useState)(0),2),i=a[0],o=a[1],s=Xe((0,n.useState)([]),2),c=s[0],m=s[1],b=(0,l.Jy)().data,P=Xe((0,n.useState)(!1),2),E=P[0],I=P[1],C=Xe((0,n.useState)(!1),2),w=C[0],S=C[1],x=Xe((0,n.useState)(!1),2),O=x[0],M=x[1],D=Xe((0,n.useState)(!1),2),j=D[0],T=D[1],L=Xe((0,n.useState)([]),2),W=L[0],k=L[1];(0,n.useEffect)((function(){h.A.policies("subscription").then((function(e){var t=e.body.list;0===t.length?v.A.info(r.formatMessage({id:"Apis.Create.APIProduct.APIProductCreateWrapper.error.policies.not.available",defaultMessage:[{type:0,value:"Throttling policies not available. Contact your administrator"}]})):t.filter((function(e){return"Unlimited"===e.name})).length>0?k(["Unlimited"]):k([t[0].name])}))}),[]);var V,R=n.createElement(nt,null,n.createElement(u.A,{variant:"h5"},n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.heading",defaultMessage:[{type:0,value:"Create an API Product"}]})),n.createElement(u.A,{variant:"caption"},n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.sub.heading",defaultMessage:[{type:0,value:"Create an API Product by providing a Name, a Context, a Version, Resources, and Business Plans (optional)."}]}))),F=Xe((0,n.useReducer)((function(e,t){var r=t.action,n=t.value;switch(r){case"type":case"name":case"context":case"version":case"isFormValid":case"apiResources":return He(He({},e),{},et({},r,n));case"preSetAPI":return He(He({},e),{},{name:n.name.replace(/[&/\\#,+()$~%.'":*?<>{}\s]/g,""),context:n.context});default:return e}}),{type:"ApiProductCreateWrapper",inputValue:"",formValidity:!1}),2),N=F[0],B=F[1],G=Xe((0,n.useState)(),2),_=G[0],U=G[1],q=[n.createElement(f.A,{variant:"caption",id:"Apis.Create.APIProduct.APIProductCreateWrapper.defineProvide",defaultMessage:[{type:0,value:"Define API Product"}]}),n.createElement(f.A,{variant:"caption",id:"Apis.Create.APIProduct.APIProductCreateWrapper.resources",defaultMessage:[{type:0,value:"Add Resources"}]})],$=function(){U(!0);var e={name:N.name,context:N.context,version:N.version,policies:W,apis:c,transport:["http","https"]};return(V=new Se.A(e)).saveProduct(e).then((function(e){return v.A.info(r.formatMessage({id:"Apis.Create.APIProduct.APIProductCreateWrapper.created.success",defaultMessage:[{type:0,value:"API Product created successfully"}]})),e})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(r.formatMessage({id:"Apis.APIProductCreateWrapper.error.errorMessage.create.api.product",defaultMessage:[{type:0,value:"Something went wrong while adding the API Product"}]}))})).finally((function(){return U(!1)})).finally((function(){return U(!1)}))};return n.createElement(n.Fragment,null,n.createElement(ze,{title:R},n.createElement(d.A,{sx:{mb:3}},n.createElement(qe.A,{alternativeLabel:!0,activeStep:i},q.map((function(e){return n.createElement($e.A,{key:e},n.createElement(Qe.A,{className:rt.alternativeLabel},e))})))),n.createElement(p.Ay,{container:!0},n.createElement(p.Ay,{item:!0,md:12},0===i&&n.createElement(we,{onValidate:function(e){B({action:"isFormValid",value:e})},onChange:function(e){var t=e.target,r=t.name,n=t.value;B({action:r,value:n})},api:N,isAPIProduct:!0}),1===i&&n.createElement(Ke.A,{apiResources:c,setApiResources:m,isStateCreate:!0,api:N})),n.createElement(p.Ay,{item:!0,md:12,sx:{mt:3}},n.createElement(p.Ay,{className:1===i&&rt.saveButton,container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},n.createElement(p.Ay,{item:!0},1===i&&n.createElement(y.A,{onClick:function(){return o((function(e){return e-1}))}},n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.back",defaultMessage:[{type:0,value:"Back"}]})),0===i&&n.createElement(A.N_,{to:"/api-products/"},n.createElement(y.A,null,n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.cancel",defaultMessage:[{type:0,value:"Cancel"}]})))),n.createElement(p.Ay,{item:!0},1===i&&n.createElement(y.A,{variant:"contained",color:"primary",disabled:!N.isFormValid||_||0===c.length||E,onClick:function(){$().then((function(e){t.push("/api-products/".concat(e.id,"/overview"))}))},id:"create-api-product-btn"},n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.create",defaultMessage:[{type:0,value:"Create"}]}),_&&!E&&n.createElement(g.A,{size:24})),0===i&&n.createElement(y.A,{onClick:function(){return o((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!N.isFormValid,id:"api-product-next-btn"},n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.next",defaultMessage:[{type:0,value:"Next"}]}))),n.createElement(p.Ay,{item:!0},1===i&&!xe.A.isNotPublisher()&&n.createElement(y.A,{variant:"contained",color:"primary",id:"create-and-publish-api-product-btn",disabled:!N.isFormValid||_||0===c.length||O||w||!N.isFormValid,onClick:function(){I(!0),$().then((function(e){S(!0),v.A.info(r.formatMessage({id:"Apis.Create.APIProduct.APIProductCreateWrapper.created.success",defaultMessage:[{type:0,value:"API Product created successfully"}]})),V.createProductRevision(e.id,{description:"Initial Revision"}).then((function(n){S(!1);var a=n.body.id;v.A.info(r.formatMessage({id:"Apis.Create.APIProduct.APIProductCreateWrapper.revision.created.success",defaultMessage:[{type:0,value:"API Revision created successfully"}]}));var i=b.environment.map((function(e){return e.name})),o=[],l=function(e){var t=b.environment.find((function(t){return t.name===e&&t.vhosts.length>0}));return t&&t.vhosts[0].host};i&&i.length>0&&(i.includes("Default")&&l("Default")?o.push({name:"Default",displayOnDevportal:!0,vhost:l("Default")}):l(i[0])&&o.push({name:i[0],displayOnDevportal:!0,vhost:l(i[0])})),M(!0),V.deployProductRevision(e.id,a,o).then((function(){v.A.info(r.formatMessage({id:"Apis.Create.APIProduct.APIProductCreateWrapper.revision.deployed.success",defaultMessage:[{type:0,value:"API Revision Deployed Successfully"}]})),M(!1),T(!0),V.updateLcState(e.id,"Publish").then((function(n){"CREATED"===n.body.workflowStatus?v.A.info(r.formatMessage({id:"Apis.Create.APIProduct.APIProductCreateWrapper.publishStatus",defaultMessage:[{type:0,value:"Lifecycle state change request has been sent"}]})):v.A.info(r.formatMessage({id:"Apis.Create.APIProduct.APIProductCreateWrapper.otherStatus",defaultMessage:[{type:0,value:"API Product status updated successfully"}]})),t.push("/api-products/".concat(e.id,"/overview"))}))})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(r.formatMessage({id:"Apis.APIProductCreateWrapper.error.errorMessage.deploy.revision",defaultMessage:[{type:0,value:"Something went wrong while deploying the API Product Revision"}]})),console.error(e)})).finally((function(){T(!1),I(!1)}))})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(r.formatMessage({id:"Apis.APIProductCreateWrapper.error.errorMessage.create.revision",defaultMessage:[{type:0,value:"Something went wrong while creating the API Product Revision"}]})),console.error(e)}))})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(r.formatMessage({id:"Apis.APIProductCreateWrapper.error.errorMessage.create.api.product",defaultMessage:[{type:0,value:"Something went wrong while adding the API Product"}]}))})).finally((function(){return U(!1)}))}},!j&&!w&&!O&&n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.create.and.publish.btn",defaultMessage:[{type:0,value:"Create & Publish"}]}),(j||w||O)&&n.createElement(g.A,{size:24}),_&&j&&n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.create.status",defaultMessage:[{type:0,value:"Creating API Product. . ."}]}),!_&&w&&!O&&n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.create.revision.status",defaultMessage:[{type:0,value:"Creating Revision . . ."}]}),!_&&j&&!w&&!O&&n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.create.publish.status",defaultMessage:[{type:0,value:"Publishing API Product. . ."}]}),!_&&j&&!w&&O&&n.createElement(f.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.create.deploy.revision.status",defaultMessage:[{type:0,value:"Deploying Revision . . ."}]}))))))))}at.propTypes={history:c().shape({push:c().func}).isRequired};var it=r(11354);function ot(e){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ot(e)}function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return st(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?st(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(r),!0).forEach((function(t){pt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function pt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=ot(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ot(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dt(e,t){var r=t.action,n=t.value;switch(r){case"type":case"inputValue":case"name":case"version":case"endpoint":case"gatewayType":case"context":case"policies":case"isFormValid":return ut(ut({},e),{},pt({},r,n));case"inputType":return ut(ut({},e),{},pt(pt({},r,n),"inputValue","url"===n?"":null));case"preSetAPI":return ut(ut({},e),{},{name:n.name.replace(/[&/\\#,+()$~%.'":*?<>{}\s]/g,""),version:n.version,context:n.context,endpoint:n.endpoints&&n.endpoints[0]});default:return e}}function ft(e){var t=lt((0,n.useState)(0),2),r=t[0],a=t[1],i=e.history,o=e.multiGateway,s=(0,l.Jy)().data,c=lt((0,n.useReducer)(dt,{type:"ApiCreateOpenAPI",inputType:"url",inputValue:"",formValidity:!1}),2),m=c[0],b=c[1],P=(0,Ue.A)();function E(e){b({action:"isFormValid",value:e})}var I=lt((0,n.useState)(),2),C=I[0],w=I[1];return n.createElement(Z,{title:n.createElement(n.Fragment,null,n.createElement(u.A,{variant:"h5"},n.createElement(f.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.heading",defaultMessage:[{type:0,value:"Create an API using an OpenAPI definition."}]})),n.createElement(u.A,{variant:"caption"},n.createElement(f.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.sub.heading",defaultMessage:[{type:0,value:"Create an API using an existing OpenAPI definition file or URL."}]})))},n.createElement(d.A,{sx:{mb:2}},n.createElement(qe.A,{alternativeLabel:!0,activeStep:r},n.createElement($e.A,null,n.createElement(Qe.A,null,n.createElement(f.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.wizard.one",defaultMessage:[{type:0,value:"Provide OpenAPI"}]}))),n.createElement($e.A,null,n.createElement(Qe.A,null,n.createElement(f.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.wizard.two",defaultMessage:[{type:0,value:"Create API"}]}))))),n.createElement(p.Ay,{container:!0,spacing:2},n.createElement(p.Ay,{item:!0,xs:12},0===r&&n.createElement(it.A,{onValidate:E,apiInputs:m,inputsDispatcher:b}),1===r&&n.createElement(we,{onValidate:E,onChange:function(e){var t=e.target,r=t.name,n=t.value;b({action:r,value:n})},multiGateway:o,api:m,isAPIProduct:!1})),n.createElement(p.Ay,{item:!0,xs:12},n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},n.createElement(p.Ay,{item:!0},0===r&&n.createElement(A.N_,{to:"/apis/"},n.createElement(y.A,null,n.createElement(f.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))),1===r&&n.createElement(y.A,{onClick:function(){return a((function(e){return e-1}))}},n.createElement(f.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.back",defaultMessage:[{type:0,value:"Back"}]}))),n.createElement(p.Ay,{item:!0},0===r&&n.createElement(y.A,{onClick:function(){return a((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!m.isFormValid,id:"open-api-create-next-btn"},n.createElement(f.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.next",defaultMessage:[{type:0,value:"Next"}]})),1===r&&n.createElement(y.A,{variant:"contained",color:"primary",disabled:!m.isFormValid||C,onClick:function(){w(!0);var e,t=m.name,r=m.version,n=m.context,a=m.endpoint,o=m.gatewayType,l=m.policies,c=void 0===l?["Unlimited"]:l,u=m.inputValue,p=m.inputType,d={name:t,version:r,context:n,gatewayType:"default"==(e=s&&1===s.gatewayTypes.length&&s.gatewayTypes.includes("Regular")?"wso2/synapse":s&&1===s.gatewayTypes.length&&s.gatewayTypes.includes("APK")?"wso2/apk":"default")?o:e,policies:c};a&&(d.endpointConfig={endpoint_type:"http",sandbox_endpoints:{url:a},production_endpoints:{url:a}});var f=new h.A(d);("file"===p?f.importOpenAPIByFile(u):f.importOpenAPIByUrl(u)).then((function(e){v.A.info(P.formatMessage({id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.created.success",defaultMessage:[{type:0,value:"API created successfully"}]})),i.push("/apis/".concat(e.id,"/overview"))})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(P.formatMessage({id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.created.error",defaultMessage:[{type:0,value:"Something went wrong while adding the API"}]})),console.error(e)})).finally((function(){return w(!1)}))},id:"open-api-create-btn"},n.createElement(f.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.create",defaultMessage:[{type:0,value:"Create"}]})," ",C&&n.createElement(g.A,{size:24})))))))}ft.propTypes={history:c().shape({push:c().func}).isRequired,multiGateway:c().string.isRequired};var mt=r(68810),yt=r(15001),At=r(36632);let vt=!1;const gt=n.forwardRef((function(e,t){return vt||(console.warn(["MUI: The Alert component was moved from the lab to the core.","","You should use `import { Alert } from '@mui/material'`","or `import Alert from '@mui/material/Alert'`"].join("\n")),vt=!0),(0,L.jsx)(At.A,(0,E.A)({ref:t},e))}));var ht=r(54937);let bt=!1;const Pt=n.forwardRef((function(e,t){return bt||(console.warn(["MUI: The AlertTitle component was moved from the lab to the core.","","You should use `import { AlertTitle } from '@mui/material'`","or `import AlertTitle from '@mui/material/AlertTitle'`"].join("\n")),bt=!0),(0,L.jsx)(ht.A,(0,E.A)({ref:t},e))}));var Et=r(51555);function It(e){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},It(e)}function Ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(r),!0).forEach((function(t){St(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function St(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=It(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=It(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==It(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ot(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ot(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Mt(e){var t=(0,Ue.A)(),r=xt((0,n.useState)(0),2),a=r[0],i=r[1],o=e.history,l=xt((0,n.useState)([]),2),s=l[0],c=l[1];(0,n.useEffect)((function(){h.A.policies("subscription").then((function(e){var r=e.body.list;0===r.length?v.A.info(t.formatMessage({id:"Apis.Create.WSDL.ApiCreateWSDL.error.policies.not.available",defaultMessage:[{type:0,value:"Throttling policies not available. Contact your administrator"}]})):r.filter((function(e){return"Unlimited"===e.name})).length>0?c(["Unlimited"]):c([r[0].name])}))}),[]);var m=xt((0,n.useReducer)((function(e,t){var r=t.action,n=t.value;switch(r){case"type":case"inputValue":case"name":case"version":case"endpoint":case"context":case"isFormValid":return wt(wt({},e),{},St({},r,n));case"inputType":return wt(wt({},e),{},St(St({},r,n),"inputValue","url"===n?"":null));default:return e}}),{type:"SOAP",inputType:"url",inputValue:"",formValidity:!1,mode:"create"}),2),b=m[0],P=m[1];function E(e){P({action:"isFormValid",value:e})}var I=xt((0,n.useState)(),2),C=I[0],w=I[1];return n.createElement(Z,{title:n.createElement(n.Fragment,null,1===a&&"SOAPTOREST"===b.type&&n.createElement(d.A,{mb:2},n.createElement(gt,{severity:"warning"},n.createElement(Pt,null,n.createElement(f.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.deprecated.msg",defaultMessage:[{type:0,value:"APIM supports only a limited set of capabilities with this feature. If you want to process complex WSDL/XML schema, please refer to the following documentation."}]})),n.createElement(yt.A,{href:"https://mi.docs.wso2.com/en/latest/develop/creating-artifacts/creating-an-api/",target:"_blank"},"WSO2 Integration Studio Documentation"))),n.createElement(u.A,{variant:"h5"},n.createElement(f.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.heading",defaultMessage:[{type:0,value:"Expose a SOAP Service as a REST API"}]})),n.createElement(u.A,{variant:"caption"},n.createElement(f.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.sub.heading",defaultMessage:[{type:0,value:"Expose an existing SOAP service as a REST API by importing the WSDL of the SOAP service."}]})))},n.createElement(d.A,{sx:{mb:2}},n.createElement(qe.A,{alternativeLabel:!0,activeStep:a},n.createElement($e.A,null,n.createElement(Qe.A,null,n.createElement(f.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.step.label.provide.wsdl",defaultMessage:[{type:0,value:"Provide WSDL"}]}))),n.createElement($e.A,null,n.createElement(Qe.A,null,n.createElement(f.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.step.label.create.api",defaultMessage:[{type:0,value:"Create API"}]}))))),n.createElement(p.Ay,{container:!0,spacing:2},n.createElement(p.Ay,{item:!0,md:12},0===a&&n.createElement(Et.A,{onValidate:E,apiInputs:b,inputsDispatcher:P}),1===a&&n.createElement(we,{onValidate:E,onChange:function(e){var t=e.target,r=t.name,n=t.value;P({action:r,value:n})},api:b,isAPIProduct:!1})),n.createElement(p.Ay,{item:!0,md:12},n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},n.createElement(p.Ay,{item:!0},0===a&&n.createElement(A.N_,{to:"/apis/"},n.createElement(y.A,null,n.createElement(f.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))),1===a&&n.createElement(y.A,{onClick:function(){return i((function(e){return e-1}))}},n.createElement(f.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.step.label.create.api.back.btn",defaultMessage:[{type:0,value:"Back"}]}))),n.createElement(p.Ay,{item:!0},0===a&&n.createElement(y.A,{onClick:function(){return i((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!b.isFormValid},n.createElement(f.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.step.label.create.api.next.btn",defaultMessage:[{type:0,value:"Next"}]})),1===a&&n.createElement(y.A,{variant:"contained",color:"primary",disabled:!b.isFormValid||C,onClick:function(){w(!0);var e=b.name,r=b.version,n=b.context,a=b.endpoint,i=b.type,l={name:e,version:r,context:n,policies:s};a&&(l.endpointConfig={endpoint_type:"SOAPTOREST"===i?"address":"http",sandbox_endpoints:{type:"SOAPTOREST"===i?"address":void 0,url:a},production_endpoints:{type:"SOAPTOREST"===i?"address":void 0,url:a}}),("url"===b.inputType?mt.A.importByUrl(b.inputValue,l,b.type):mt.A.importByFileOrArchive(b.inputValue,l,b.type)).then((function(e){v.A.info(t.formatMessage({id:"Apis.Create.WSDL.ApiCreateWSDL.create.success",defaultMessage:[{type:0,value:"API created successfully"}]})),o.push("/apis/".concat(e.id,"/overview"))})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(t.formatMessage({id:"Apis.Create.WSDL.ApiCreateWSDL.create.error",defaultMessage:[{type:0,value:"Something went wrong while adding the API"}]})),console.error(e)})).finally((function(){return w(!1)}))}},n.createElement(f.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.step.label.create.api.create.btn",defaultMessage:[{type:0,value:"Create"}]})," ",C&&n.createElement(g.A,{size:24})))))))}Mt.propTypes={history:c().shape({push:c().func}).isRequired};var Dt=r(27601);function jt(e){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jt(e)}function Tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Lt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(r),!0).forEach((function(t){Wt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Wt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=jt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==jt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Vt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Vt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Rt(e){var t=(0,Ue.A)(),r=e.multiGateway,a=kt((0,n.useState)(0),2),o=a[0],s=a[1],c=(0,i.W6)(),m=(0,l.Jy)().data,b=kt((0,n.useState)([]),2),P=b[0],E=b[1];(0,n.useEffect)((function(){h.A.policies("subscription").then((function(e){var r=e.body.list;0===r.length?v.A.info(t.formatMessage({id:"Apis.Create.GraphQL.ApiCreateGraphQL.error.policies.not.available",defaultMessage:[{type:0,value:"Throttling policies not available. Contact your administrator"}]})):r.filter((function(e){return"Unlimited"===e.name})).length>0?E(["Unlimited"]):E([r[0].name])}))}),[]);var I=kt((0,n.useReducer)((function(e,t){var r=t.action,n=t.value;switch(r){case"type":case"inputValue":case"name":case"version":case"gatewayType":case"endpoint":case"context":case"isFormValid":case"graphQLInfo":return Lt(Lt({},e),{},Wt({},r,n));case"inputType":return Lt(Lt({},e),{},Wt(Wt({},r,n),"inputValue","url"===n?"":null));case"preSetAPI":return Lt(Lt({},e),{},{name:n.name.replace(/[&/\\#,+()$~%.'":*?<>{}\s]/g,""),version:n.version,context:n.context});default:return e}}),{type:"ApiCreateGraphQL",inputType:"file",inputValue:"",formValidity:!1}),2),C=I[0],w=I[1];function S(e){w({action:"isFormValid",value:e})}var x=kt((0,n.useState)(),2),O=x[0],M=x[1];return n.createElement(Z,{title:n.createElement(n.Fragment,null,n.createElement(u.A,{variant:"h5"},n.createElement(f.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.heading",defaultMessage:[{type:0,value:"Create an API using a GraphQL SDL definition"}]})),n.createElement(u.A,{variant:"caption"},n.createElement(f.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.sub.heading",defaultMessage:[{type:0,value:"Create an API by importing an existing GraphQL SDL definition."}]})))},n.createElement(d.A,{sx:{mb:2}},n.createElement(qe.A,{alternativeLabel:!0,activeStep:o},n.createElement($e.A,null,n.createElement(Qe.A,null,n.createElement(f.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.wizard.one",defaultMessage:[{type:0,value:"Provide GraphQL"}]}))),n.createElement($e.A,null,n.createElement(Qe.A,null,n.createElement(f.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.wizard.two",defaultMessage:[{type:0,value:"Create API"}]}))))),n.createElement(p.Ay,{container:!0,spacing:2},n.createElement(p.Ay,{item:!0,md:12},0===o&&n.createElement(Dt.A,{onValidate:S,apiInputs:C,inputsDispatcher:w}),1===o&&n.createElement(we,{onValidate:S,onChange:function(e){var t=e.target,r=t.name,n=t.value;w({action:r,value:n})},multiGateway:r,api:C,isAPIProduct:!1})),n.createElement(p.Ay,{item:!0,xs:12},n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},n.createElement(p.Ay,{item:!0},0===o&&n.createElement(A.N_,{to:"/apis/"},n.createElement(y.A,null,n.createElement(f.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))),1===o&&n.createElement(y.A,{onClick:function(){return s((function(e){return e-1}))}},n.createElement(f.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.back",defaultMessage:[{type:0,value:"Back"}]}))),n.createElement(p.Ay,{item:!0},0===o&&n.createElement(y.A,{onClick:function(){return s((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!C.isFormValid,"data-testid":"create-graphql-next-btn"},n.createElement(f.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.next",defaultMessage:[{type:0,value:"Next"}]})),1===o&&n.createElement(y.A,{variant:"contained",color:"primary",disabled:!C.isFormValid||O,onClick:function(){M(!0);var e,r=C.name,n=C.version,a=C.context,i=C.endpoint,o=C.gatewayType,l=C.implementationType,s=C.inputValue,u=C.graphQLInfo.operations;e=m&&1===m.gatewayTypes.length&&m.gatewayTypes.includes("Regular")?"wso2/synapse":m&&1===m.gatewayTypes.length&&m.gatewayTypes.includes("APK")?"wso2/apk":"default";var p={name:r,version:n,context:a,gatewayType:"default"===e?o:e,policies:P,operations:u},d="file";i&&(p.endpointConfig={endpoint_type:"http",sandbox_endpoints:{url:i},production_endpoints:{url:i}});var f=new h.A(p),y=Wt(Wt({additionalProperties:JSON.stringify(p),implementationType:l},d,d),"file",s);f.importGraphQL(y).then((function(e){var n=e.obj.id;v.A.info(t.formatMessage({id:"Apis.Create.GraphQL.ApiCreateGraphQL.created.success",defaultMessage:[{type:1,value:"name"},{type:0,value:" API created successfully"}]},{name:r})),c.push("/apis/".concat(n,"/overview"))})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(t.formatMessage({id:"Apis.Create.GraphQL.ApiCreateGraphQL.created.error",defaultMessage:[{type:0,value:"Something went wrong while adding the API"}]})),console.error(e)})).finally((function(){return M(!1)}))},"data-testid":"itest-create-graphql-api-button"},n.createElement(f.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.create",defaultMessage:[{type:0,value:"Create"}]})," ",O&&n.createElement(g.A,{size:24})))))))}Rt.propTypes={multiGateway:c().shape({content:c().string}).isRequired};const Ft=function(){return n.createElement(_e,{isWebSocket:!0})};var Nt=r(17681),Bt=r(82241);function Gt(e){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gt(e)}function _t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(r),!0).forEach((function(t){Qt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $t(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$t(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Qt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Gt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Gt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var zt={mandatoryStar:"".concat("APICreateStreamingAPI","-mandatoryStar")},Kt=(0,a.Ay)(Z)((function(e){var t=e.theme;return Qt({},"& .".concat(zt.mandatoryStar),{color:t.palette.error.main,marginLeft:t.spacing(.1)})})),Jt=function e(t){var r=t.history,a=(0,Ue.A)(),o=(0,l.Jy)(),s=o.data,c=o.isLoading,m=o.error,P=qt((0,n.useState)(null),2),E=P[0],I=P[1];(0,n.useEffect)((function(){m&&I(m.message)}),[m]);var C=qt((0,n.useState)(),2),w=C[0],S=C[1],x=qt((0,n.useState)(!1),2),O=x[0],M=x[1],D=qt((0,n.useState)(!1),2),j=D[0],T=D[1],L=qt((0,n.useState)(!1),2),W=L[0],k=L[1],V=qt((0,n.useState)(!1),2),R=V[0],F=V[1],N=qt((0,n.useState)([]),2),B=N[0],G=N[1],_=(0,i.g)().apiType;_&&(_=_.toUpperCase());var U="WEBSUB"===_;(0,n.useEffect)((function(){h.A.asyncAPIPolicies().then((function(e){var t=e.body.list;0===t.length?v.A.info(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.policies.not.available",defaultMessage:[{type:0,value:"Throttling policies not available. Contact your administrator"}]})):U&&t.filter((function(e){return"AsyncWHUnlimited"===e.policyName})).length>0?G(["AsyncWHUnlimited"]):!U&&t.filter((function(e){return"AsyncUnlimited"===e.policyName})).length>0?G(["AsyncUnlimited"]):G([t[0].policyName])}))}),[]);var q={WebSocket:"WS",SSE:"SSE",WebSub:"WEBSUB"},$=qt((0,n.useState)(!_||_===q.WebSub),2),Q=$[0],z=$[1],K=qt((0,n.useReducer)((function(e,t){var r=t.action,n=t.value;switch(r){case"name":case"version":case"context":case"endpoint":case"policies":case"isFormValid":return Ut(Ut({},e),{},Qt({},r,n));case"protocol":return z(q[n]===q.WebSub),Ut(Ut({},e),{},Qt({},r,q[n]));default:return e}}),{formValidity:!1}),2),J=K[0],Y=K[1],H=J.name&&J.context&&J.version&&!w;function X(e){var t=e.target,r=t.name,n=t.value;Y({action:r,value:n})}function Z(){S(!0);var e=J.name,t=J.version,r=J.context,n=J.endpoint,i=J.protocol,o={name:e,version:t,context:r,endpoint:n,type:_||i.toUpperCase(),policies:B},l="http";return(_&&"WS"===_.toUpperCase()||i&&"WS"===i.toUpperCase())&&(l="ws"),n&&(o.endpointConfig={endpoint_type:l,sandbox_endpoints:{url:n},production_endpoints:{url:n}}),new h.A(o).saveStreamingAPI().then((function(e){return v.A.info(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.streaming.success",defaultMessage:[{type:0,value:"API created successfully"}]})),e})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.streaming.error",defaultMessage:[{type:0,value:"Something went wrong while adding the API"}]})),console.error(e),M(!1)})).finally((function(){S(!1)})).finally((function(){return S(!1)}))}var te=n.createElement(n.Fragment,null,n.createElement(u.A,{variant:"h5"},n.createElement(f.A,{id:"Apis.Create.StreamingAPI.APICreateStreamingAPI.api.heading",defaultMessage:[{type:0,value:"Create a Streaming API"}]})),n.createElement(u.A,{variant:"caption"},U?n.createElement(f.A,{id:"Apis.Create.StreamingAPI.APICreateStreamingAPI.websub.api.sub.heading",defaultMessage:[{type:0,value:"Create an API by providing a Name, a Version and a Context"}]}):n.createElement(f.A,{id:"Apis.Create.StreamingAPI.APICreateStreamingAPI.api.sub.heading",defaultMessage:[{type:0,value:"Create an API by providing a Name, a Version, a Context and the Endpoint"}]})));return n.createElement(Kt,{title:te},n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"center",alignItems:"center"},E&&n.createElement(p.Ay,{item:!0,xs:11},n.createElement(b.A,{onClose:function(){return I(null)},disableActions:!0,dense:!0,paperProps:{elevation:1},type:"error",message:E})),n.createElement(p.Ay,{item:!0,xs:12},c&&n.createElement(d.A,{mt:-2},n.createElement(g.A,{"data-testid":"loading-publisher-settings"}))),n.createElement(p.Ay,{item:!0,xs:12},n.createElement(we,{onValidate:function(e){Y({action:"isFormValid",value:e})},onChange:X,api:J,endpointPlaceholderText:"Streaming Provider",appendChildrenBeforeEndpoint:!0,hideEndpoint:Q,isWebSocket:_&&_===q.WebSocket||J.protocol===q.WebSocket},n.createElement(ee.A,{fullWidth:!0,select:!0,label:n.createElement(n.Fragment,null,n.createElement(f.A,{id:"Apis.Create.streaming.Components.SelectPolicies.business.plans",defaultMessage:[{type:0,value:"Protocol"}]}),n.createElement("sup",{className:zt.mandatoryStar},"*")),value:_?{WS:"WebSocket",SSE:"SSE",WEBSUB:"WebSub"}[_]:J.protocol,disabled:_,name:"protocol",SelectProps:{multiple:!1,renderValue:function(e){return e}},margin:"normal",variant:"outlined",InputProps:{id:"itest-id-apipolicies-input"},onChange:X},[{displayName:"WebSocket",description:"WebSocket API"},{displayName:"WebSub",description:"WebHook API based on WebSub specification"},{displayName:"SSE",description:"Server-Sent Events"}].map((function(e){return n.createElement(Nt.A,{dense:!0,disableGutters:!1,value:e.displayName},n.createElement(Bt.A,{primary:e.displayName,secondary:e.description}))}))))),n.createElement(p.Ay,{item:!0,xs:12},n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},n.createElement(p.Ay,{item:!0},n.createElement(y.A,{variant:"contained",color:"primary",disabled:!(H&&J.isFormValid),onClick:function(){Z().then((function(e){r.push("/apis/".concat(e.id,"/overview"))}))},"data-testid":"itest-create-streaming-api-button"},n.createElement(f.A,{id:"Apis.Create.streaming.Components.create.btn",defaultMessage:[{type:0,value:"Create"}]})," ",w&&!R&&n.createElement(g.A,{size:24}))),!xe.A.isNotPublisher()&&n.createElement(p.Ay,{item:!0},n.createElement(y.A,{id:"itest-id-apicreatedefault-createnpublish",variant:"contained",color:"primary",disabled:W||j||!H||!J.isFormValid,onClick:function(){var t=new h.A;F(!0),Z().then((function(n){T(!0),t.createRevision(n.id,{description:"Initial Revision"}).then((function(i){var o=i.body.id;v.A.info(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.streaming.revision.success",defaultMessage:[{type:0,value:"API Revision created successfully"}]})),T(!1);var l=s.environment.map((function(e){return e.name})),c=[],u=function(e){var t=s.environment.find((function(t){return t.name===e&&t.vhosts.length>0}));return t&&t.vhosts[0].host};if(s.gatewayTypes&&1===s.gatewayTypes.length)l&&l.length>0&&(l.includes("Default")&&u("Default")?c.push({name:"Default",displayOnDevportal:!0,vhost:u("Default")}):u(l[0])&&c.push({name:l[0],displayOnDevportal:!0,vhost:u(l[0])}));else{var p=s.environment,d=!1;p.forEach((function(e){!d&&"Regular"===e.gatewayType&&u(e.name)&&(c.push({name:e.name,displayOnDevportal:!0,vhost:u(e.name)}),d=!0)}))}k(!0),t.deployRevision(n.id,o,c).then((function(){v.A.info(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.streaming.revision.deployed.",defaultMessage:[{type:0,value:"API Revision Deployed Successfully"}]})),k(!1),M(!0),n.publish().then((function(t){t.body.workflowStatus===e.WORKFLOW_STATUS.CREATED?v.A.info(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.success.publishStatus",defaultMessage:[{type:0,value:"Lifecycle state change request has been sent"}]})):v.A.info(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.success.otherStatus",defaultMessage:[{type:0,value:"API updated successfully"}]})),r.push("/apis/".concat(n.id,"/overview"))})).catch((function(e){e.response?(v.A.error(e.response.body.description),I(e.response.body)):(v.A.error(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.errorMessage.publish",defaultMessage:[{type:0,value:"Something went wrong while publishing the API"}]})),I("Something went wrong while publishing the API")),console.error(e)})).finally((function(){M(!1),F(!1)}))})).catch((function(e){e.response?(v.A.error(e.response.body.description),I(e.response.body)):(v.A.error(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.errorMessage.deploy.revision",defaultMessage:[{type:0,value:"Something went wrong while deploying the API Revision"}]})),I("Something went wrong while deploying the API Revision")),console.error(e)})).finally((function(){k(!1)}))})).catch((function(e){e.response?(v.A.error(e.response.body.description),I(e.response.body)):(v.A.error(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.errorMessage.create.revision",defaultMessage:[{type:0,value:"Something went wrong while creating the API Revision"}]})),I("Something went wrong while creating the API Revision")),console.error(e)})).finally((function(){T(!1)}))}))}},!O&&!j&&!W&&n.createElement(f.A,{id:"Apis.Create.streaming.Components.create.and.publish.btn",defaultMessage:[{type:0,value:"Create & Publish"}]}),(O||j||W)&&n.createElement(g.A,{size:24}),w&&O&&"Creating API . . .",!w&&j&&!W&&"Creating Revision . . .",!w&&O&&!j&&!W&&"Publishing API . . .",!w&&O&&!j&&W&&"Deploying Revision . . .")),n.createElement(p.Ay,{item:!0},n.createElement(A.N_,{to:"/apis/"},n.createElement(y.A,{variant:"text"},n.createElement(f.A,{id:"Apis.Create.Default.APICreateDefault.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))))))))};Jt.WORKFLOW_STATUS={CREATED:"CREATED"};const Yt=(0,i.y)(Jt);var Ht=r(87070),Xt=r.n(Ht),Zt=r(57555),er=r(4531);const tr=function(e){var t=e.classes,r=e.apiInputs,a=e.inputsDispatcher,i=e.isValidExternalEndpoint,o=e.setValidExternalEndpoint,l=e.validateEndpoint;return n.createElement(n.Fragment,null,n.createElement(ee.A,{fullWidth:!0,id:"itest-id-api-external-endpoint-input",label:n.createElement(n.Fragment,null,n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.externalEndpoint",defaultMessage:[{type:0,value:"External Endpoint"}]}),n.createElement("sup",{className:t.mandatoryStar},"*")),name:"externalEndpoint",value:r.externalEndpoint,onChange:function(e){var t=e.target,r=t.name,n=t.value;o(l(n)),a({action:r,value:n})},helperText:!i&&n.createElement("div",{style:{marginTop:"10px"}},n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.externalEndpoint.error",defaultMessage:[{type:0,value:"Invalid Endpoint URL"}]})),error:!i,margin:"normal",variant:"outlined"}),n.createElement(er.A,{severity:"warning",className:t.externalEndpointWarning},n.createElement(u.A,{gutterBottom:!0,component:"div",className:t.alertTitle},n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.advertiseOnly.warning.title",defaultMessage:[{type:0,value:'"Other" type streaming APIs will be created as third party APIs.'}]})),n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.advertiseOnly.warning",defaultMessage:[{type:0,value:"API Manager only supports the streaming APIs of types WebSocket, SSE and WebSub. Please create one of the supported types if you want to deploy it in the gateway."}]})))};var rr=r(84999);function nr(e){return nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nr(e)}function ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ir(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(r),!0).forEach((function(t){sr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ar(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function or(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return lr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function sr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=nr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=nr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==nr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var cr="ApiCreateAsyncAPI",ur={mandatoryStar:"".concat(cr,"-mandatoryStar"),externalEndpointWarning:"".concat(cr,"-externalEndpointWarning"),alertTitle:"".concat(cr,"-alertTitle")},pr=(0,a.Ay)(Z)((function(e){var t=e.theme;return sr(sr(sr({},"& .".concat(ur.mandatoryStar),{color:t.palette.error.main,marginLeft:t.spacing(.1)}),"& .".concat(ur.externalEndpointWarning),{marginTop:t.spacing(2),marginBottom:t.spacing(2)}),"& .".concat(ur.alertTitle),{fontWeight:t.typography.fontWeightMedium,marginTop:-2})}));function dr(e){var t=or((0,n.useState)(0),2),r=t[0],a=t[1],i=e.history,o=or((0,n.useState)(!0),2),l=o[0],s=o[1],c=or((0,n.useState)(!0),2),m=c[0],b=c[1],P=or((0,n.useState)(!0),2),E=P[0],I=P[1],C=(0,Ue.A)(),w=or((0,n.useReducer)((function(e,t){var r=t.action,n=t.value;switch(r){case"type":case"inputValue":case"name":case"version":case"endpoint":case"gatewayVendor":case"asyncTransportProtocols":case"protocol":case"context":case"policies":case"isFormValid":case"externalEndpoint":return ir(ir({},e),{},sr({},r,n));case"inputType":return ir(ir({},e),{},sr(sr({},r,n),"inputValue","url"===n?"":null));case"preSetAPI":return ir(ir({},e),{},{name:n.name.replace(/[&/\\#,+()$~%.'":*?<>{}\s]/g,""),version:n.version,context:n.context,endpoint:n.endpoints&&n.endpoints[0],gatewayVendor:n.gatewayVendor,asyncTransportProtocols:n.asyncTransportProtocols});default:return e}}),{type:"ApiCreateAsyncAPI",inputType:"url",inputValue:"",formValidity:!1}),2),S=w[0],x=w[1],O={WebSocket:"WS",SSE:"SSE",WebSub:"WEBSUB",Other:"ASYNC"};function M(e){return!!e&&!Xt().string().uri().empty().validate(e).error}function D(e){x({action:"isFormValid",value:e})}var j=or((0,n.useState)(),2),T=j[0],L=j[1];return n.createElement(pr,{title:n.createElement(n.Fragment,null,n.createElement(u.A,{variant:"h5"},n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.heading",defaultMessage:[{type:0,value:"Create an API using an AsyncAPI definition."}]})),n.createElement(u.A,{variant:"caption"},n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.sub.heading",defaultMessage:[{type:0,value:"Create an API using an existing AsyncAPI definition file or URL."}]})))},n.createElement(d.A,{sx:{mb:2}},n.createElement(qe.A,{alternativeLabel:!0,activeStep:r},n.createElement($e.A,null,n.createElement(Qe.A,null,n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.wizard.one",defaultMessage:[{type:0,value:"Provide AsyncAPI"}]}))),n.createElement($e.A,null,n.createElement(Qe.A,null,n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.wizard.two",defaultMessage:[{type:0,value:"Create API"}]}))))),n.createElement(p.Ay,{container:!0,spacing:2},n.createElement(p.Ay,{item:!0,xs:12},0===r&&n.createElement(rr.A,{onValidate:D,apiInputs:S,inputsDispatcher:x}),1===r&&n.createElement(we,{onValidate:D,onChange:function(e){var t=e.target,r=t.name,n=t.value;x({action:r,value:n})},api:S,isAPIProduct:!1,hideEndpoint:l,endpointPlaceholderText:"Streaming Provider",appendChildrenBeforeEndpoint:!0},n.createElement(p.Ay,{container:!0,spacing:2},"solace"===S.gatewayVendor&&0!==S.asyncTransportProtocols.length&&n.createElement(n.Fragment,null,n.createElement(p.Ay,{item:!0,xs:12,md:6,lg:3},n.createElement(u.A,{component:"p",variant:"subtitle2"},n.createElement(f.A,{id:"Apis.Details.NewOverview.MetaData.solace.transports",defaultMessage:[{type:0,value:"Available Protocols"}]}))),n.createElement(p.Ay,{item:!0,xs:12,md:6,lg:9},S.asyncTransportProtocols.map((function(e){return n.createElement(ae.A,{"data-testid":(0,Zt.mf)(e)+"-label",key:e,label:(0,Zt.mf)(e),style:{"font-size":13,height:20,marginRight:5},color:"primary"})}))))),"wso2"===S.gatewayVendor&&n.createElement(ee.A,{fullWidth:!0,select:!0,label:n.createElement(n.Fragment,null,n.createElement(f.A,{id:"Apis.Create.asyncAPI.Components.SelectPolicies.business.plans",defaultMessage:[{type:0,value:"Protocol"}]}),n.createElement("sup",{className:ur.mandatoryStar},"*")),value:S.protocol,name:"protocol",SelectProps:{multiple:!1,renderValue:function(e){return e}},margin:"normal",variant:"outlined",InputProps:{id:"itest-id-apipolicies-input"},onChange:function(e){var t=e.target,r=t.name,n=t.value;"WebSub"===n?(s(!0),b(!0),I(!0)):"Other"===n?(s(!0),b(!1),I(M(S.externalEndpoint))):(s(!1),b(!0),I(!0)),x({action:r,value:n})}},[{name:"ws",displayName:"WebSocket",description:"WebSocket API"},{name:"websub",displayName:"WebSub",description:"WebHook API based on WebSub specification"},{name:"sse",displayName:"SSE",description:"Server-Sent Events"},{name:"other",displayName:"Other",description:"Other Async APIs such as AMQP, MQTT etc."}].map((function(e){return n.createElement(Nt.A,{dense:!0,disableGutters:!1,id:e.name,key:e.name,value:e.displayName},n.createElement(Bt.A,{primary:e.displayName,secondary:e.description}))}))),!m&&n.createElement(tr,{classes:ur,apiInputs:S,inputsDispatcher:x,isValidExternalEndpoint:E,setValidExternalEndpoint:I,validateEndpoint:M}))),n.createElement(p.Ay,{item:!0,xs:12},n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},n.createElement(p.Ay,{item:!0},0===r&&n.createElement(A.N_,{to:"/apis/"},n.createElement(y.A,null,n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))),1===r&&n.createElement(y.A,{onClick:function(){return a((function(e){return e-1}))}},n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.back",defaultMessage:[{type:0,value:"Back"}]}))),n.createElement(p.Ay,{item:!0},0===r&&n.createElement(y.A,{"data-testid":"next-btn",onClick:function(){return a((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!S.isFormValid},n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.next",defaultMessage:[{type:0,value:"Next"}]})),1===r&&n.createElement(y.A,{"data-testid":"asyncapi-create-btn",variant:"contained",color:"primary",disabled:!S.isFormValid||T||!E,onClick:function(){L(!0);var e=S.name,t=S.version,r=S.context,n=S.endpoint,a=S.policies,o=S.inputValue,l=S.inputType,s=S.protocol,c=S.gatewayVendor,u=S.externalEndpoint,p={name:e,version:t,context:r,policies:a,type:O[s],gatewayVendor:c};"solace"===c&&(p.type=O.WebSub),n&&(p.endpointConfig={endpoint_type:"http",sandbox_endpoints:{url:n},production_endpoints:{url:n}}),"ASYNC"===O[s]&&(p.advertiseInfo={advertised:!0,apiExternalProductionEndpoint:u,apiExternalSandboxEndpoint:u,originalDevPortalUrl:"",apiOwner:"admin",vendor:"WSO2"});var d=new h.A(p);("file"===l?d.importAsyncAPIByFile(o):d.importAsyncAPIByUrl(o)).then((function(e){v.A.info(C.formatMessage({id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.created.success",defaultMessage:[{type:0,value:"API created successfully"}]})),i.push("/apis/".concat(e.id,"/overview"))})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(C.formatMessage({id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.created.error",defaultMessage:[{type:0,value:"Something went wrong while adding the API"}]})),console.error(e)})).finally((function(){return L(!1)}))}},n.createElement(f.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.create",defaultMessage:[{type:0,value:"Create"}]})," ",T&&n.createElement(g.A,{size:24})))))))}dr.propTypes={history:c().shape({push:c().func}).isRequired};var fr=r(6652),mr=r(15956);function yr(e){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yr(e)}function Ar(){return Ar=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ar.apply(null,arguments)}function vr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return gr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var hr={mandatoryStar:"".concat("ProvideAIOpenAPI","-mandatoryStar")},br=(0,a.Ay)("div")((function(e){var t=e.theme;return function(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=yr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==yr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},"& .".concat(hr.mandatoryStar),{color:t.palette.error.main})}));function Pr(e){var t=e.inputsDispatcher,r=e.onValidate,a=vr((0,n.useState)(null),2),i=a[0],o=a[1],l=vr((0,n.useState)(null),2),s=l[0],c=l[1],d=vr((0,n.useState)(null),2),m=d[0],y=d[1],A=(0,Ue.A)();return(0,n.useEffect)((function(){y(null),t({action:"importingContent",value:null}),t({action:"inputValue",value:null}),t({action:"isFormValid",value:!1})}),[s]),(0,n.useEffect)((function(){h.A.getLLMProviders().then((function(e){o(e.body)})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(A.formatMessage({id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.LLM.Provider.fetch.error",defaultMessage:[{type:0,value:"Something went wrong while fetching LLM Providers"}]}))}))}),[]),n.createElement(br,null,i&&n.createElement(p.Ay,{container:!0},n.createElement(p.Ay,{item:!0,xs:12,sx:{mb:2}},n.createElement(oe.A,{component:"fieldset",sx:{width:"100%"}},n.createElement(se.A,{component:"legend",sx:{width:"100%"}},n.createElement(mr.A,{fullWidth:!0,id:"AI-providers-autocomplete",options:function(e){if(!e)return[];var t=[];return e.list.forEach((function(e){t.includes(e.name)||t.push(e.name)})),t}(i),noOptionsText:"No AI/LLM Service Provider defined",value:s,onChange:function(e,t){c(t)},renderOption:function(e,t){return n.createElement("li",e,t)},renderInput:function(e){return n.createElement(ee.A,Ar({},e,{fullWidth:!0,label:0!==i.list.length?n.createElement(n.Fragment,null,n.createElement(f.A,{id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.AI.provider",defaultMessage:[{type:0,value:"AI/LLM Service Provider"}]}),n.createElement("sup",{className:hr.mandatoryStar},"*")):n.createElement(f.A,{id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.AI.provider.empty",defaultMessage:[{type:0,value:"No AI/LLM Service Provider defined."}]}),placeholder:A.formatMessage({id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.AI.provider.placeholder",defaultMessage:[{type:0,value:"Search AI/LLM Service Provider"}]}),helperText:n.createElement(f.A,{id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.AI.provider.helper.text",defaultMessage:[{type:0,value:"Select AI/LLM Service Provider for the API"}]}),margin:"dense",variant:"outlined",id:"APIProvider"}))}})))),n.createElement(p.Ay,{item:!0,xs:12,sx:{mb:2}},n.createElement(oe.A,{component:"fieldset",sx:{width:"100%"}},n.createElement(se.A,{component:"legend",sx:{width:"100%"}},n.createElement(mr.A,{fullWidth:!0,id:"AI-model-autocomplete",options:i.list.filter((function(e){return e.name===s})),noOptionsText:"No AI/LLM Service Provider selected",getOptionLabel:function(e){return e.apiVersion},value:m,onChange:function(e,n){y(n),n?h.A.getLLMProviderAPIDefinition(n.id).then((function(e){!function(e,n){var a=e.text;h.A.validateOpenAPIByInlineDefinition(a).then((function(e){if(!e.body.isValid)throw new Error("Invalid OpenAPI definition");t({action:"llmProviderId",value:n.id}),t({action:"inputValue",value:a}),t({action:"preSetAPI",value:e.body.info}),r(e.body.isValid)})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(A.formatMessage({id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.LLMProvider.API.Definition.validation.failure.error",defaultMessage:[{type:0,value:"Error while validating the LLM Provider API Definition"}]})),t({action:"inputValue",value:null}),t({action:"isFormValid",value:!1}),r(!1)}))}(e,n)})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(A.formatMessage({id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.LLMProvider.API.Definition.fetch.error",defaultMessage:[{type:0,value:"Something went wrong while fetching LLM Provider API Definition"}]}))})):t({action:"isFormValid",value:!1})},renderOption:function(e,t){return n.createElement("li",e,t.apiVersion)},renderInput:function(e){return n.createElement(ee.A,Ar({},e,{fullWidth:!0,label:0!==i.list.length?n.createElement(n.Fragment,null,n.createElement(f.A,{id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.AI.model",defaultMessage:[{type:0,value:"API version"}]}),n.createElement("sup",{className:hr.mandatoryStar},"*")):n.createElement(f.A,{id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.AI.model.empty",defaultMessage:[{type:0,value:"No AI/LLM Service Provider selected."}]}),placeholder:A.formatMessage({id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.AI.model.placeholder",defaultMessage:[{type:0,value:"Search API version"}]}),helperText:n.createElement(f.A,{id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.AI.model.helper",defaultMessage:[{type:0,value:"Select API version for the API"}]}),margin:"dense",variant:"outlined",id:"APIModelVersion"}))}})))),n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-end",alignItems:"center"},n.createElement(p.Ay,{item:!0},n.createElement(u.A,{variant:"caption",display:"block",gutterBottom:!0},n.createElement("sup",{style:{color:"red"}},"*")," ",n.createElement(f.A,{id:"Apis.Create.Components.DefaultAPIForm.mandatory.fields",defaultMessage:[{type:0,value:"Mandatory fields"}]}))))),!i&&n.createElement(p.Ay,{container:!0},n.createElement(p.Ay,{item:!0,xs:12,sx:{mb:2}},n.createElement(u.A,null,n.createElement(f.A,{id:"Apis.Create.AIAPI.Steps.ProvideAIOpenAPI.AI.provider.loading",defaultMessage:[{type:0,value:"Loading AI/LLM Service Providers..."}]})))))}function Er(e){return Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Er(e)}function Ir(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Cr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Sr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wr(Object(r),!0).forEach((function(t){xr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Er(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Er(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Or(e,t){var r=t.action,n=t.value;switch(r){case"type":case"inputValue":case"name":case"version":case"endpoint":case"gatewayType":case"context":case"policies":case"llmProviderId":case"isFormValid":return Sr(Sr({},e),{},xr({},r,n));case"preSetAPI":return Sr(Sr({},e),{},{name:n.name.replace(/[&/\\#,+()$~%.'":*?<>{}\s]/g,""),version:n.version,context:n.context,endpoint:n.endpoints&&n.endpoints[0]});default:return e}}function Mr(e){var t=Ir((0,n.useState)(0),2),r=t[0],a=t[1],i=e.history,o=e.multiGateway,s=(0,l.Jy)().data,c=Ir((0,n.useReducer)(Or,{type:"ApiCreateAIAPI",inputValue:"",formValidity:!1}),2),m=c[0],b=c[1],P=(0,Ue.A)();function E(e){b({action:"isFormValid",value:e})}var I=Ir((0,n.useState)(),2),C=I[0],w=I[1];return n.createElement(Z,{title:n.createElement(n.Fragment,null,n.createElement(u.A,{variant:"h5"},n.createElement(f.A,{id:"Apis.Create.AIAPI.ApiCreateAIAPI.heading",defaultMessage:[{type:0,value:"Create an API using an AI/LLM Service provider API definition."}]})),n.createElement(u.A,{variant:"caption"},n.createElement(f.A,{id:"Apis.Create.AIAPI.ApiCreateAIAPI.sub.heading",defaultMessage:[{type:0,value:"Create an API using an existing AI/LLM Service provider API definition."}]})))},n.createElement(d.A,{sx:{mb:2}},n.createElement(qe.A,{alternativeLabel:!0,activeStep:r},n.createElement($e.A,null,n.createElement(Qe.A,null,n.createElement(f.A,{id:"Apis.Create.AIAPI.ApiCreateAIAPI.wizard.one",defaultMessage:[{type:0,value:"Provide AI/LLM Service provider API"}]}))),n.createElement($e.A,null,n.createElement(Qe.A,null,n.createElement(f.A,{id:"Apis.Create.AIAPI.ApiCreateAIAPI.wizard.two",defaultMessage:[{type:0,value:"Create API"}]}))))),n.createElement(p.Ay,{container:!0,spacing:2},n.createElement(p.Ay,{item:!0,xs:12},0===r&&n.createElement(Pr,{onValidate:E,inputsDispatcher:b}),1===r&&n.createElement(we,{onValidate:E,onChange:function(e){var t=e.target,r=t.name,n=t.value;b({action:r,value:n})},multiGateway:o,api:m,isAPIProduct:!1,hideEndpoint:!0})),n.createElement(p.Ay,{item:!0,xs:12},n.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},n.createElement(p.Ay,{item:!0},0===r&&n.createElement(A.N_,{to:"/apis/"},n.createElement(y.A,null,n.createElement(f.A,{id:"Apis.Create.AIAPI.ApiCreateAIAPI.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))),1===r&&n.createElement(y.A,{onClick:function(){return a((function(e){return e-1}))}},n.createElement(f.A,{id:"Apis.Create.AIAPI.ApiCreateAIAPI.back",defaultMessage:[{type:0,value:"Back"}]}))),n.createElement(p.Ay,{item:!0},0===r&&n.createElement(y.A,{onClick:function(){return a((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!m.isFormValid,id:"ai-api-create-next-btn"},n.createElement(f.A,{id:"Apis.Create.AIAPI.ApiCreateAIAPI.next",defaultMessage:[{type:0,value:"Next"}]})),1===r&&n.createElement(y.A,{variant:"contained",color:"primary",disabled:!m.isFormValid||C,onClick:function(){w(!0);var e,t=m.name,r=m.version,n=m.context,a=m.endpoint,o=m.gatewayType,l=m.policies,c=void 0===l?["Unlimited"]:l,u=m.inputValue,p=m.llmProviderId,d={name:t,version:r,context:n,gatewayType:"default"==(e=s&&1===s.gatewayTypes.length&&s.gatewayTypes.includes("Regular")?"wso2/synapse":s&&1===s.gatewayTypes.length&&s.gatewayTypes.includes("APK")?"wso2/apk":"default")?o:e,policies:c,subtypeConfiguration:{subtype:"AIAPI",configuration:{llmProviderId:p}},securityScheme:[fr.pg],egress:!0};a&&(d.endpointConfig={endpoint_type:"http",sandbox_endpoints:{url:a},production_endpoints:{url:a}}),new h.A(d).importOpenAPIByInlineDefinition(u).then((function(e){v.A.info(P.formatMessage({id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.created.success",defaultMessage:[{type:0,value:"API created successfully"}]})),i.push("/apis/".concat(e.id,"/overview"))})).catch((function(e){e.response?v.A.error(e.response.body.description):v.A.error(P.formatMessage({id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.created.error",defaultMessage:[{type:0,value:"Something went wrong while adding the API"}]}))})).finally((function(){return w(!1)}))},id:"ai-api-create-btn"},n.createElement(f.A,{id:"Apis.Create.AIAPI.ApiCreateAIAPI.create",defaultMessage:[{type:0,value:"Create"}]})," ",C&&n.createElement(g.A,{size:24})))))))}function Dr(e){return Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dr(e)}function jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Tr(){return Tr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tr.apply(null,arguments)}Pr.defaultProps={onValidate:function(){}},Pr.propTypes={inputsDispatcher:c().func.isRequired,onValidate:c().func},Mr.propTypes={history:c().shape({push:c().func}).isRequired,multiGateway:c().string.isRequired};var Lr,Wr,kr,Vr={content:"".concat("APICreateRoutes","-content")},Rr=(0,a.Ay)("div")((Lr={},kr={flexGrow:1},(Wr=function(e){var t=function(e,t){if("object"!=Dr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=Dr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Dr(t)?t:t+""}(Wr="&.".concat(Vr.content)))in Lr?Object.defineProperty(Lr,Wr,{value:kr,enumerable:!0,configurable:!0,writable:!0}):Lr[Wr]=kr,Lr)),Fr=function(e,t){return function(r){return n.createElement(e,Tr({},r,t))}};const Nr=function(){var e=(0,l.Jy)().data,t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,l=[],s=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return jr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(!1),2),r=t[0],a=t[1];return(0,n.useEffect)((function(){null!=e&&(e.gatewayTypes&&2===e.gatewayTypes.length?a(!0):a(!1))}),[e]),n.createElement(Rr,{className:Vr.content},n.createElement(i.dO,null,n.createElement(i.qh,{path:"/apis/create/rest",component:Fr(_e,{multiGateway:r})}),n.createElement(i.qh,{path:"/api-products/create",component:at}),n.createElement(i.qh,{path:"/apis/create/graphQL",component:Fr(Rt,{multiGateway:r})}),n.createElement(i.qh,{path:"/apis/create/openapi",component:Fr(ft,{multiGateway:r})}),n.createElement(i.qh,{path:"/apis/create/wsdl",component:Mt}),n.createElement(i.qh,{path:"/apis/create/ws",component:Ft}),n.createElement(i.qh,{path:"/apis/create/streamingapi/:apiType",component:Yt}),n.createElement(i.qh,{path:"/apis/create/asyncapi",component:dr}),n.createElement(i.qh,{path:"/apis/create/ai-api",component:Fr(Mr,{multiGateway:r})}),n.createElement(i.qh,{component:o.A})))}}}]);
//# sourceMappingURL=APICreateRoutes.953b371a4ef430ecd706.bundle.js.map